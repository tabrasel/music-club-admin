<div class="h-100 p-3 ">
  <div class="h-100 p-3 d-flex flex-column border rounded" id="album-info">
    <header class="mb-2 d-flex justify-content-between">
      <div>
        <h3>{{ album.title }}</h3>
        <h4>{{ album.artists.join(', ') }}</h4>
      </div>

      <!--
      <div *ngIf="poster !== null && poster !== undefined" class="poster-icon" [style.background-color]="poster.color">
        <p class="m-0">{{ poster.firstName[0] + poster.lastName[0] }}</p>
      </div>
      -->
    </header>

    <div class="mb-2 d-flex justify-content-between align-items-center">
      <small class="mr-3 metrics-warning" *ngIf="remainingVotes > 0">Missing {{ remainingVotes }} vote(s)</small>
      <small class="mr-3 metrics-warning" *ngIf="remainingVotes < 0">Has {{ -remainingVotes }} extra vote(s)</small>

      <small class="mr-3" title="Vote overlap percentage. There is 0% overlap if everyone votes for different songs. Likewise, there is 100% overlap if everyone votes for the same number of songs as there are votes per person." *ngIf="remainingVotes === 0"><i class="fas fa-handshake"></i> {{ concensusScore | number : '1.0-0' }}%</small>

      <small class="mr-3" title="The percentage of liked songs out of the whole album." *ngIf="remainingVotes === 0"><i class="fas fa-arrows-alt-h"></i> {{ coverage | number : '1.0-0' }}%</small>
    </div>

    <div class="flex-grow-1 position-relative">
      <div class="h-100 p-2 list-group scrollable-list-group">
        <div
          class="position-relative list-group-item list-group-item-action track-list-item"
          [class.top-track]="album.topTrackNumber === trackListItem.track.trackNumber"
          *ngFor="let trackListItem of trackListItems"
          (click)="populateTrackForm(trackListItem.track)"
          data-bs-toggle="modal" data-bs-target="#track-form-modal">
          <div class="d-flex justify-content-between align-items-center">
            <p class="track-title">{{ trackListItem.track.trackNumber }}. {{ trackListItem.track.title }}</p>

            <div class="d-flex">
              <div
                class="picker-icon d-flex justify-content-center align-items-center mr-1"
                *ngFor="let picker of trackListItem.pickers"
                [style.background-color]="picker.color">
                <p *ngIf="picker !== null">{{ picker.firstName[0] + picker.lastName[0] }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Track form modal -->
<div class="modal fade" id="track-form-modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Track Editor</h5>
      </div>

      <div class="modal-body">
        <form id="track-form" [formGroup]="trackForm" (ngSubmit)="submitTrackForm()" class="needs-validation">
          <div class="row">
            <div class="col">
              <div class="form-group mb-3">
                <label class="form-label" title="The participants who voted for this track.">Pickers</label>
                <div class="form-check" formArrayName="pickerIds" *ngFor="let control of pickerIdsFormArray.controls; let i = index">
                  <input class="form-check-input" type="checkbox" [formControlName]="i" value="">
                  <label class="form-check-label">{{ participants[i].firstName }} {{ participants[i].lastName }}</label>
                </div>
              </div>

              <div class="form-group">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault" formControlName="isTopTrack">
                  <label class="form-check-label" for="flexCheckDefault" title="Was this the top voted track?">Is Top Track?</label>
                </div>
              </div>
            </div>
            </div>
        </form>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-sm btn-secondary" id="track-modal-close-button" data-bs-dismiss="modal" (click)="clearTrackForm()">Cancel</button>
        <button type="submit" form="track-form" class="btn btn-sm btn-primary" [disabled]="!trackForm.valid">Save</button>
      </div>
    </div>
  </div>
</div>
